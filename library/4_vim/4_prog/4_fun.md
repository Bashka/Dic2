Функции
Объявление и использование функций
==================================

Функции в VimScript объявляются с помощью следующей записи:

    function <имя>(<аргументы>)
        <тело>
    endfunction

Как и переменные, функции имеют аналогичные области видимости. Области указываются перед именем функции. Функции в глобальной области видимости должны начинаться на заглавную букву.

Если указать восклицательный знак (!) после записи 'function', то функция будет переопределяющей, то есть в случае, если функция с данным именем уже существует, она будет заменена на данную.

Ниже приведен пример функции:

    function MyFun()
        echo 'Hello world'
    endfunction

Для просмотра списка всех объявленных функций, используется команда `:function`. Если указать после имени этой команды шаблон поиска, то будут показаны те функции, которые удовлетворяют этому шаблону.

Аргументы
---------

Аргументы функции перечисляются через запятую и имеют область видимости 'a' (не указывается при объявлении, а только при использовании в теле функции).

Если функция может принимать динамическое число аргументов, используется запись '...'. Доступ к динамическим аргументам в теле функции осуществляется с помощью следующий переменных:

* `a:000` - массив всех динамических аргументов;
* `a:1`, `a:2`, ..., `a:9` - динамические аргументы в порядке из передачи;
* `a:0` - количество переданных динамических аргументов.

Ниже приведен пример функции с аргументами:

    function MyFun(a, b, ...)
        for v in a:000
            echo 'Dinamic arg: ' . v
        endfor
        echo a:a + a:b
    endfunction

Возврат значений из функции
---------------------------

Для возврата значений из функции используется следующая команда:

    return <значение>

После выполнения возврата, функция завершает свою работу и все нижестоящие операции не будут выполнены.

Ниже приведен пример функции, возвращающей значение:

    function Sum(x, y)
        return a:x + a:y
    endfunction

Вызов функции
-------------

Для вызова функции используется команда вида:

    call <областьВидимости>:<имя>(<параметры>)

Команда 'call' применяется в том случае, когда функция не возвращает значений или эти значения не важны. В противном случае вызов функции возможен прямо внутри выражений. Ниже приведен пример вызова такой функции:

    echo 5 + sin(45)

Здесь вызывается функция 'sin', вычисляющая синус.

Функцию так же можно вызвать с помощью другой функции, которая называется `call`. Данная функция принимает в качестве первого параметра имя целевой функции или ссылку на нее, а в качестве второго массив параметров, которые должны быть переданы в эту функцию при вызове, и возвращает то, что вызываемая функция. Данная функция так же принимает третий параметр, относящийся к ООП в VimScript, он рассматривается в соответствующем разделе. Ниже приведен пример использования данной функции:

    echo call('sin', [45])

Ссылки на функции
=================

VimScript позволяет создавать ссылки на функции. Для этого используется функция `function`, которая принимает в качестве своего единственного параметра имя целевой функции. Ниже приведен пример, в котором создается ссылка на функцию:

    function SayHello(name)
        echo 'Hello ' . a:name
    endfunction
    let s:refFun = function('SayHello')

Вызов таких ссылок осуществляется аналогично обычным функциям:

    <ссылка>(<парметры>)
    call(<ссылка>, [<параметры>])

Ниже приведен пример вызова созданной ранее ссылки `s:refFun`:

    call s:refFun('world')
    call call(s:refFun, ['world'])
