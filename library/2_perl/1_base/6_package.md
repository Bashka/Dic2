Пакеты и модули
Файл пакета
===========

Для создания пакета необходимо создать файл, имя которого соответствует имени пакета с расширением pm. Так, для пакета с именем MyPackage файл его содержащий должен называться MyPackage.pm.

Объявление пространства имен
============================

Для объявления пространства имен пакета используется запись:

    namespace <имя>;

Соглашение Perl требует, чтобы имя пакета начиналось с заглавной буквы. Пакет можно разместить в каталоге, при этом пространство имен должно повторить адрес файла в файловой системе по средствам объявления подпространств, разделенных символом ::

    namespace <имяКаталога>::<имяПакета>;

Ниже пирведен пример пространства имен для пакета MyPackage, размещенного в каталоге packages/my/:

    namespace <packages>::<my>::MyPackage;

Использование пакета
====================

Для подключение пакета к текущему скрипту используется запись:

    use [<имяКаталога>::]<имяПакета>;

При этом все переменные и функции, объявленные в данном пакете будут доступны в текущем скрипте. Perl самостоятельно найден файл пакета в файловой системе по полному имени пакета и загрузит его.

Важно помнить что операция use действует на уровне текущего блока, то есть после выхода из блока кода, в котором она используется, подключаемый ею пакет будет недоступен. Так же можно отключить пакет принудительно с помощью следующей записи:

    no [<имяКаталога>::]<имяПакета>;

Для доступа к переменным и функциям пакета используется запись:

    <полноеИмяПакета>::<переменная>;
    <полноеИмяПакета>::<функция>();

Ниже приведен пример подключения и использования пакета MyPackage.pm:

    use MyPackage;
    $MyPackage::var = 1; # Использование переменной пакета.
    MyPackage::fun(); # Вызов функции пакета.

Для получения имени текущего пакета используется константа __PACKAGE__.

CPAN
====

CPAN это всемирный архив модулей Perl. С помощью данного архива можно расширить имеющийся в Perl функционал.

Установить модуль CPAN можно двумя спомобами:

* Скачав модуль и установив его вручную;
* Используя модуль CPAN, представляющий простой менеджер пакетов Perl.

Использование CPAN
------------------

Для использования менеджера CPAN, достаточно выполнить в терминале следующую команду:

    perl -MCPAN -e "shell"

Если вы впервые пользуетесь данным менеджером, он выполнит первоначальное конфигурирование системы. Сюда входит выбор каталога, используемого для хранения устанавливаемых модулей. В качестве локального каталога пользователя используется каталог `~/.cpan`.

После ввода данной команды, вы перейдете в командную строку менеджера. Ниже приведены основные команды:

* `install имяМодуля` - установка модуля;
* `upgrade имяМодуля` - обновление модуля.

Ниже приведен пример команды для установки модуля:

    install XML::DOM

Для установки некоторых модулей могут потребоваться права суперпользователя.

Ручная установка
----------------

Для установки модуля в ручную, необходимо скачать его архив с [официального сайта](http://www.cpan.org) и выполнить следующие действия:

1. Распаковать архив в каталог;
1. Выполнить сборку make файла с помощью perl - `perl Makefile.PL`;
1. Выполнить сборку проекта с помощью полученного make файла - `make`;
1. Выполнить тестирование модуля - `make test`;
1. Выполнить установку модуля в хранилище - `make install`.

Для последней операции могут потребоваться права суперпользователя. Для обхода этой проблемы, необходимо изменить команду сборки make файла на следующую:

    perl Makefile.PL LIB=каталогБиблиотеки INSTALLMAN1DIR=каталогРуководства1 INSTALLMAN3DIR=каталогРуководства2 INSTALLBIN=каталогBin INSTALLSCRIPT=каталогScripts

После чего выполнить оставшиеся команды как указано выше. При этом модуль будет установлен в "каталог библиотеки" и получить к нему доступ можно будет заранее указав Perl этот каталог:

    use lib "каталогБиблиотеки";
    use установленныйМодуль;
