Канальный уровень
Задачи
======

Канальный уровень отвечает за передачу данных между узлами одной сети. Для идентификации узлов, используются сетевые интерфейсы узла и их MAC-адреса.

В связи с тем, что на канальном уровне не существует информации о сетях и их топологии, здесь возможна передача сигнала только по заданным сетевым интерфейсам с указанием MAC-адреса получателя в заголовке кадра. Никакая логика маршрутизации данных здесь использоваться не может.

Данный уровень следит за тем, чтобы каждый кадр был передан и получен в целости и повторно поредан в случае ошибки между двумя узлами, но он не отвечает за последовательность передачи, что не исключает ситуацию, когда кадры могут прийти не в заданном порядке.

Кадр
====

Единицей данных на канальном уровне является кадр. Существует несколько форматов структуры кадра, ниже приведены некоторые из них:

Ethernet DIX
------------

Наиболее распространенный вид кадра, который имеет минимальный размер в 72 байта и максимальный в 1526 байт. Он состоит из:

|             Наименование              | Размер (байт) | Описание                                                                                                                                 |
|---------------------------------------|---------------|------------------------------------------------------------------------------------------------------------------------------------------|
|Преамбула (Preamble)                   |8              |Поле, используемое для определения начала кадра. Состоит из 7 байт вида 10101010 и 8-го байта вида 10101011                               |
|Адрес получателя (Destination address) |6              |Поле, содержащее MAC-адрес получателя                                                                                                     |
|Адрес отправителя (Source address)     |6              |Поле, содержащее MAC-адрес отправителя                                                                                                    |
|Размер кадра (Length)                  |2              |Поле, определяющее размер кадра целиком без преамбулы (может иметь значение от 64 до 1518 байт). Используется для определения конца кадра |
|Данные (Data)                          |от 46 до 1500  |Непосредственно сами данные                                                                                                               |
|Контрольная сумма (FCS)                |4              |Хэш-сумма по CRC32, вычисляемая для кадра и определяющая его целостность при получении                                                    |

IEEE Ethernet 802.3
-------------------

Кадр используется для повышения надежности передачи данных по каналам связи. Он имеет минимальный размер в 72 байта и максимальный в 1526 байт. Он состоит из:

|             Наименование              | Размер (байт) | Описание                                                                                                                                 |
|---------------------------------------|---------------|------------------------------------------------------------------------------------------------------------------------------------------|
|Преамбула (Preamble)                   |7              |Поле, используемое для определения начала кадра. Состоит из 7 байт вида 10101010                                                          |
|SD                                     |1              |Поле, используемое для определения конца преамбулы. Состоит из байта вида 10101011                                                        |
|Адрес получателя (Destination address) |6              |Поле, содержащее MAC-адрес получателя                                                                                                     |
|Адрес отправителя (Source address)     |6              |Поле, содержащее MAC-адрес отправителя                                                                                                    |
|Размер кадра (Length)                  |2              |Поле, определяющее размер кадра целиком без преамбулы (может иметь значение от 64 до 1518 байт). Используется для определения конца кадра |
|DSAP                                   |1              |Поле, определяющее адрес службы получателя данных                                                                                         |
|SSAP                                   |1              |Поле, определяющее адрес службы отправителя данных                                                                                        |
|Control                                |1              |Поле, определяющее действие, которое необходимо выполнить с данными                                                                       |
|Данные (Data)                          |от 43 до 1497  |Непосредственно сами данные                                                                                                               |
|Контрольная сумма (FCS)                |4              |Хэш-сумма по CRC32, вычисляемая для кадра и определяющая его целостность при получении                                                    |

Данный кадр аналогичен DIX с той лишь разницей, что 5 байт поля данных отводится под поля DSAP, SSAP и Control.

Оборудование
============

На канальном уровне функционирует следующее оборудование:

Сетевой комутатор
-----------------

Сетевой комутатор, или switch, представляет собой устройство, объединяющее несколько узлов в одну сеть. Он функционирует следующим образом:

1. При получении кадра, устройство запоминает на какой сетевой интерфейс (порт) поступил данный кадр и какой MAC-адрес отправителя. В будущем это позволит передавать пакеты на указанный MAC-адрес направлено, а не широковещательно;
2. Если в памяти устрйства не определен порт для MAC-адреса отправителя, кадр рассылается на все сетевые интерфейсы устройства, кроме того, из которого он поступил;
3. Получившие кадр узлы сверяют свой MAC-адрес с MAC-адресом получателя кадра и если они отличаются, кадр отбрасывается.

Сетевой комутатор имеет следующие недостатки:

* Излишняя нагрузка на сеть из-за широковещательной рассылки;
* Низкая безопасность, связанная с тем, что кадры передаются всем узлам сети, а не только адресату.

Два соединенных между собой сетевых комутатора позволяют передавать кадры между сетями (звездами сетевой топологии). Реализуется это аналогично, через широковещательную рассылку обоих комутаторов.
